:root{
  --bg:#1a1a2e;--panel:rgba(255,255,255,.08);--panel-solid:#121727;
  --border:rgba(255,255,255,.15);
  --txt:#fff;--muted:#c9c9d6;--primary:#667eea;--accent:#f5576c;
}
*{box-sizing:border-box}
html.modal-lock, body.modal-lock{ overflow:hidden !important; }
body{
  margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:linear-gradient(135deg,#0f0f23,#1a1a2e);color:var(--txt);
  padding-bottom:96px; /* место под плеер */
}
.container{max-width:420px;margin:0 auto;padding:16px}
.header{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:16px;text-align:center}
.logo{font-size:24px;font-weight:800;margin-bottom:6px}
.tagline{color:var(--muted);font-size:13px}
.stats{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin:16px 0}
.stat{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:12px;text-align:center}
.stat-value{font-weight:800;font-size:18px}
.stat-label{font-size:11px;color:var(--muted)}
.actions{display:grid;gap:10px}
.btn{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:14px 16px;color:var(--txt);font-weight:700;cursor:pointer}
.btn.primary{background:linear-gradient(45deg,#667eea,#764ba2);border-color:transparent}
.btn.accent{background:linear-gradient(45deg,#f093fb,#f5576c);border-color:transparent}
.btn:hover{filter:brightness(1.05)}
.hidden{display:none}

/* Modals */
.modal{
  position:fixed;inset:0;background:rgba(0,0,0,.85);
  display:flex;align-items:center;justify-content:center;padding:16px;z-index:1200
}
.modal-content{
  background:var(--panel);border:1px solid var(--border);border-radius:16px;
  max-width:420px;width:100%;overflow:hidden;
  display:flex;flex-direction:column;max-height:85vh;
}
.modal-content.solid{background:var(--panel-solid);}
.modal-header{
  background:linear-gradient(45deg,#667eea,#764ba2);
  display:flex;justify-content:space-between;align-items:center;padding:12px 14px;flex:0 0 auto;
}
.modal-title{font-weight:800}
.modal-close{background:rgba(255,255,255,.2);border:none;color:#fff;border-radius:10px;cursor:pointer;width:32px;height:32px}
.modal-body{
  padding:12px;flex:1 1 auto;min-height:0;overflow-y:auto; /* скролл внутри модалки по умолчанию */
}

/* В игре скролл внутри отключаем, и даём нижний отступ, чтобы плеер не перекрывал */
#gameModal .modal-body{
  overflow: hidden !important;
  padding: 12px 12px 160px 12px !important; /* гарантировано выше плеера */
}
#bbModal .modal-body{
  overflow: hidden !important;
  padding: 12px 12px 160px 12px !important; /* гарантировано выше плеера */
}

/* Game */
.game-frame{
  position:relative;
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px;background:#0b0b0f;
}
#gameCanvas,
#bbCanvas{
  display:block;margin:0 auto;border:1px solid #000;border-radius:6px;background:#000;max-width:100%;
  touch-action:none; /* без тач-скролла */
}
.game-info{display:flex;gap:12px;justify-content:center;margin:8px 0;color:#c9c9d6}

/* Game over overlay */
.gameover-overlay{
  position:absolute; inset:0; z-index:2000;
  background:rgba(0,0,0,0.65);
  display:flex; align-items:center; justify-content:center;
  pointer-events:auto;
}
.gameover-panel{
  background:linear-gradient(135deg,#1e2233,#15192b);
  border:1px solid var(--border);
  border-radius:14px;
  padding:16px; width:90%; max-width:280px; text-align:center;
}
.go-title{font-weight:800; font-size:18px; margin-bottom:8px}
.go-score,.go-best{color:#cfd3e1; margin:4px 0}

/* Music */
.album-picker{display:flex;flex-direction:column;gap:10px;margin-bottom:10px}
#albumSearch{
  width:100%;padding:10px 12px;border-radius:10px;
  border:1px solid var(--border);background:#0e1322;color:#fff;outline:none
}
#albumSearch::placeholder{color:#889}
.search-results{
  background:#0e1322;border:1px solid var(--border);border-radius:10px;overflow:hidden
}
.search-results .row{
  padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.06);cursor:pointer
}
.search-results .row:last-child{border-bottom:none}
.search-results .row:hover{background:#121831;color:#fff}

.track{display:flex;align-items:center;justify-content:space-between;gap:10px;background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:10px;margin-bottom:8px}
.track.locked{opacity:.55}
.track .info{font-size:13px}
.track .title{font-weight:800}
.track .artist{color:#c9c9d6;font-size:12px}
.track .play{background:var(--panel);border:1px solid var(--border);border-radius:10px;color:#fff;font-weight:700;padding:8px 12px;cursor:pointer}

/* Toast */
.toast{
  position:fixed;right:12px;bottom:108px;
  background:linear-gradient(45deg,#4ecdc4,#44a08d);padding:10px 14px;border-radius:12px;
  box-shadow:0 8px 24px rgba(0,0,0,.35);z-index:1300
}

/* Player bar */
.player-bar{
  position:fixed;left:0;right:0;bottom:0;z-index:1400;
  background:linear-gradient(45deg,#1b1e2b,#23273a);
  border-top:1px solid var(--border);
  display:flex;align-items:center;justify-content:space-between;gap:12px;
  padding:10px 12px; pointer-events:auto;
}
.player-meta{min-width:0;flex:1}
.player-title{font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60vw}
.player-artist{font-size:12px;color:#c9c9d6;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60vw}
.player-progress{margin-top:6px;height:6px;background:#0e1322;border:1px solid var(--border);border-radius:6px;position:relative;cursor:pointer}
.player-progress-fill{position:absolute;left:0;top:0;bottom:0;width:0;background:linear-gradient(90deg,#667eea,#764ba2);border-radius:6px}
.player-time{display:flex;justify-content:space-between;gap:10px;margin-top:4px;font-size:11px;color:#cbd}
.player-controls{display:flex;gap:8px}
.pbtn{background:var(--panel);border:1px solid var(--border);border-radius:10px;color:#fff;padding:8px 12px;cursor:pointer;font-weight:800}
.pbtn:hover{filter:brightness(1.08)}
