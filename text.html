<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soundkeeper Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: #1a1a2e;
            color: white;
            padding: 20px;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #4ecdc4;
            margin-bottom: 20px;
        }
        
        .score {
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }
        
        button {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: #4ecdc4;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
        }
        
        button:hover {
            background: #45b7d1;
        }
        
        #gameArea {
            display: none;
            text-align: center;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            margin: 20px 0;
        }
        
        #gameCanvas {
            border: 2px solid #4ecdc4;
            background: black;
            display: block;
            margin: 10px auto;
        }
        
        .track-list {
            margin: 20px 0;
        }
        
        .track {
            padding: 10px;
            margin: 5px 0;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
        }
        
        .track.locked {
            opacity: 0.5;
        }
        
        #notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4ecdc4;
            padding: 15px;
            border-radius: 10px;
            display: none;
            animation: slideIn 0.3s;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéµ Soundkeeper</h1>
        
        <div class="score">
            –û—á–∫–∏: <span id="score">0</span> | 
            –¢—Ä–µ–∫–∏: <span id="tracks">0</span>/5
        </div>
        
        <button onclick="startGame()">üéÆ –ò–≥—Ä–∞—Ç—å –≤ –ø—Ä–æ—Å—Ç—É—é –∏–≥—Ä—É</button>
        <button onclick="showTracks()">üéµ –ú–æ–∏ —Ç—Ä–µ–∫–∏</button>
        <button onclick="resetAll()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
        
        <div id="gameArea">
            <h2>–ö–ª–∏–∫–∞–π –ø–æ –∫–≤–∞–¥—Ä–∞—Ç–∞–º!</h2>
            <canvas id="gameCanvas" width="300" height="300"></canvas>
            <button onclick="stopGame()">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–≥—Ä—É</button>
        </div>
        
        <div id="tracksArea" style="display: none;">
            <h2>–¢–≤–æ–∏ —Ç—Ä–µ–∫–∏:</h2>
            <div class="track-list" id="trackList"></div>
            <button onclick="hideTracks()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>
    
    <div id="notification"></div>

    <script>
        // –ü—Ä–æ—Å—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–≥—Ä—ã
        let score = 0;
        let unlockedTracks = [];
        let gameActive = false;
        
        // –°–ø–∏—Å–æ–∫ —Ç—Ä–µ–∫–æ–≤
        const allTracks = [
            { id: 1, name: 'Track 1', artist: 'Artist A' },
            { id: 2, name: 'Track 2', artist: 'Artist B' },
            { id: 3, name: 'Track 3', artist: 'Artist C' },
            { id: 4, name: 'Track 4', artist: 'Artist D' },
            { id: 5, name: 'Track 5', artist: 'Artist E' }
        ];
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        function loadData() {
            const saved = localStorage.getItem('soundkeeper_data');
            if (saved) {
                const data = JSON.parse(saved);
                score = data.score || 0;
                unlockedTracks = data.tracks || [];
            }
            updateDisplay();
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        function saveData() {
            localStorage.setItem('soundkeeper_data', JSON.stringify({
                score: score,
                tracks: unlockedTracks
            }));
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function updateDisplay() {
            document.getElementById('score').textContent = score;
            document.getElementById('tracks').textContent = unlockedTracks.length;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(text) {
            const notif = document.getElementById('notification');
            notif.textContent = text;
            notif.style.display = 'block';
            setTimeout(() => {
                notif.style.display = 'none';
            }, 3000);
        }
        
        // –ü–†–û–°–¢–ê–Ø –ò–ì–†–ê
        function startGame() {
            document.getElementById('gameArea').style.display = 'block';
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            
            gameActive = true;
            let targets = [];
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–π
            function createTarget() {
                targets.push({
                    x: Math.random() * 250,
                    y: Math.random() * 250,
                    size: 30 + Math.random() * 20,
                    color: `hsl(${Math.random() * 360}, 70%, 50%)`,
                    lifetime: 100
                });
            }
            
            // –ö–ª–∏–∫ –ø–æ –∫–∞–Ω–≤–∞—Å—É
            canvas.onclick = function(e) {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–¥–∞–Ω–∏—è
                for (let i = targets.length - 1; i >= 0; i--) {
                    const target = targets[i];
                    const dist = Math.sqrt((x - target.x - target.size/2) ** 2 + 
                                          (y - target.y - target.size/2) ** 2);
                    
                    if (dist < target.size/2) {
                        targets.splice(i, 1);
                        score += 10;
                        updateDisplay();
                        saveData();
                        
                        // –®–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å —Ç—Ä–µ–∫
                        if (Math.random() < 0.3 && unlockedTracks.length < allTracks.length) {
                            unlockRandomTrack();
                        }
                        
                        showNotification('+10 –æ—á–∫–æ–≤!');
                        break;
                    }
                }
            };
            
            // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
            function gameLoop() {
                if (!gameActive) return;
                
                // –û—á–∏—Å—Ç–∫–∞
                ctx.fillStyle = '#000';
                ctx.fillRect(0, 0, 300, 300);
                
                // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ü–µ–ª–µ–π
                if (Math.random() < 0.02) {
                    createTarget();
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ü–µ–ª–µ–π
                for (let i = targets.length - 1; i >= 0; i--) {
                    const target = targets[i];
                    target.lifetime--;
                    
                    if (target.lifetime <= 0) {
                        targets.splice(i, 1);
                        continue;
                    }
                    
                    // –†–∏—Å—É–µ–º —Ü–µ–ª—å
                    ctx.fillStyle = target.color;
                    ctx.globalAlpha = target.lifetime / 100;
                    ctx.fillRect(target.x, target.y, target.size, target.size);
                    ctx.globalAlpha = 1;
                }
                
                requestAnimationFrame(gameLoop);
            }
            
            gameLoop();
        }
        
        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–≥—Ä—ã
        function stopGame() {
            gameActive = false;
            document.getElementById('gameArea').style.display = 'none';
        }
        
        // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç—Ä–µ–∫–∞
        function unlockRandomTrack() {
            const locked = allTracks.filter(t => !unlockedTracks.includes(t.id));
            if (locked.length > 0) {
                const track = locked[Math.floor(Math.random() * locked.length)];
                unlockedTracks.push(track.id);
                saveData();
                updateDisplay();
                showNotification(`üéµ –ù–æ–≤—ã–π —Ç—Ä–µ–∫: ${track.name}!`);
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ç—Ä–µ–∫–∏
        function showTracks() {
            document.getElementById('tracksArea').style.display = 'block';
            const listEl = document.getElementById('trackList');
            listEl.innerHTML = '';
            
            allTracks.forEach(track => {
                const isUnlocked = unlockedTracks.includes(track.id);
                const div = document.createElement('div');
                div.className = `track ${isUnlocked ? '' : 'locked'}`;
                div.innerHTML = `
                    <span>${isUnlocked ? 'üéµ' : 'üîí'} ${track.name} - ${track.artist}</span>
                    <button onclick="playTrack(${track.id})" ${isUnlocked ? '' : 'disabled'}>
                        ${isUnlocked ? '‚ñ∂Ô∏è' : 'üîí'}
                    </button>
                `;
                listEl.appendChild(div);
            });
        }
        
        // –°–∫—Ä—ã—Ç—å —Ç—Ä–µ–∫–∏
        function hideTracks() {
            document.getElementById('tracksArea').style.display = 'none';
        }
        
        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Ç—Ä–µ–∫
        function playTrack(id) {
            const track = allTracks.find(t => t.id === id);
            if (track) {
                showNotification(`‚ñ∂Ô∏è –ò–≥—Ä–∞–µ—Ç: ${track.name}`);
            }
        }
        
        // –°–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        function resetAll() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω!')) {
                score = 0;
                unlockedTracks = [];
                saveData();
                updateDisplay();
                showNotification('–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—à–µ–Ω!');
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        loadData();
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
        console.log('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ! –í–µ—Ä—Å–∏—è: TEST');
        showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Soundkeeper!');
    </script>
</body>
</html>
